<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>DiNKR Pickleball Americano Tournament</title>
    <!-- Reliable CDN sources for React -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent;
        }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', sans-serif; 
            background: #325682; 
            min-height: 100vh;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
            touch-action: manipulation;
            padding-bottom: 60px;
            color: white;
        }
        
        /* Button styles optimized for mobile */
        .btn { 
            border: none; 
            border-radius: 8px; 
            font-weight: bold; 
            cursor: pointer; 
            transition: all 0.2s; 
            touch-action: manipulation;
            -webkit-appearance: none;
            user-select: none;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .btn:hover, .btn:active { 
            transform: translateY(-1px); 
            opacity: 0.9;
        }
        .btn:disabled { 
            opacity: 0.5; 
            cursor: not-allowed; 
            transform: none; 
        }
        
        /* Input styles optimized for mobile */
        .input { 
            border: 2px solid #64748b; 
            border-radius: 4px; 
            padding: 12px; 
            font-size: 16px;
            outline: none;
            touch-action: manipulation;
            -webkit-appearance: none;
            -moz-appearance: textfield;
            min-height: 44px;
        }
        .input:focus { 
            border-color: #deff01; 
        }
        .input::-webkit-outer-spin-button,
        .input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        /* Card and layout styles */
        .card { 
            background: rgba(255, 255, 255, 0.1); 
            backdrop-filter: blur(10px); 
            border-radius: 12px; 
            padding: 20px; 
            margin: 16px auto;
            width: 100%;
        }
        
        /* Message styles */
        .error-message {
            background: #fed7d7;
            color: #9b2c2c;
            padding: 16px;
            border-radius: 8px;
            margin: 16px 0;
        }
        .success-message {
            background: #c6f6d5;
            color: #276749;
            padding: 16px;
            border-radius: 8px;
            margin: 16px 0;
        }
        
        /* Loading spinner */
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #deff01;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Mobile-optimized containers */
        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Court styling - mobile optimized */
        .court-wrapper {
            margin: 0 auto 24px;
            max-width: 100%;
            width: 100%;
        }
        .court-container {
            background: #f7fafc;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            display: grid;
            grid-template-columns: 2fr 1fr 4px 1fr 2fr;
            border: 2px solid white;
            border-radius: 0px;
            width: 100%;
            max-width: 380px;
            margin: 0 auto;
        }
        .court-team {
            display: grid;
            grid-template-rows: 1fr 1fr;
        }
        .court-team.left {
            border-right: 2px solid white;
        }
        .court-team.right {
            border-left: 2px solid white;
        }
        .court-player {
            background-color: #325682;
            color: white;
            text-align: center;
            padding: 24px 16px;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 60px;
            transition: all 0.2s;
        }
        .court-player.top {
            border-bottom: 2px solid white;
        }
        .court-player.clickable {
            cursor: pointer;
        }
        .court-player.clickable:hover {
            background-color: #4a6fa5;
            transform: scale(1.02);
        }
        .court-player.selected {
            background-color: #deff01;
            color: #1a202c;
        }
        .court-score-input {
            width: 52px;
            height: 52px;
            text-align: center;
            font-size: 22px;
            font-weight: bold;
            border: none;
            background-color: white;
            outline: none;
            border-radius: 0px;
            touch-action: manipulation;
            -webkit-appearance: none;
        }
        .court-score-input:disabled {
            background-color: #f3f4f6;
            color: #9ca3af;
            cursor: not-allowed;
        }
        
        /* Number input controls */
        .number-input-container {
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
        }
        .number-input-btn {
            background: #deff01;
            color: #1a202c;
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 6px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            touch-action: manipulation;
            -webkit-appearance: none;
            user-select: none;
        }
        .number-input-btn:hover, .number-input-btn:active {
            background: #c5d601;
            transform: translateY(-1px);
        }
        .number-input-btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
        }
        
        /* Timer styles */
        .timer-display {
            display: inline-block;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 28px;
            font-weight: bold;
            border: 3px solid #000;
            min-width: 120px;
            text-align: center;
        }
        .timer-normal {
            background-color: #000;
            color: white;
        }
        .timer-warning {
            background-color: #dc2626;
            color: white;
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        /* Dialog styles */
        .dialog-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            padding: 20px;
        }
        .dialog-content {
            background-color: white;
            border-radius: 16px;
            padding: 24px;
            max-width: 90vw;
            max-height: 80vh;
            overflow-y: auto;
            color: #1a202c;
            width: 100%;
            -webkit-overflow-scrolling: touch;
        }
        
        /* Player grid for dialogs */
        .player-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
            margin: 20px 0;
        }
        .player-button {
            padding: 12px 8px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: #1a202c;
            transition: all 0.2s;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .player-button.selected {
            border-color: #325682;
            background-color: #deff01;
            color: #1a202c;
        }
        .player-button:disabled {
            background-color: #f8f9fa;
            color: #9ca3af;
            cursor: not-allowed;
        }
        
        /* Match display in dialogs */
        .match-display {
            border: 2px solid #325682;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
            background-color: #f8f9fa;
        }
        .team-display {
            text-align: center;
            margin: 8px 0;
        }
        .team-label {
            font-size: 12px;
            color: #64748b;
            margin-bottom: 8px;
        }
        .player-chip {
            padding: 8px 12px;
            margin: 4px;
            background-color: #325682;
            color: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            display: inline-block;
            transition: all 0.2s;
        }
        .player-chip:hover {
            background-color: #4a6fa5;
            transform: scale(1.02);
        }
        
        /* Results styling */
        .results-grid {
            display: grid;
            gap: 8px;
            margin: 16px 0;
        }
        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            border-radius: 6px;
            background-color: rgba(255, 255, 255, 0.05);
        }
        .result-item.winner {
            background-color: rgba(222, 255, 1, 0.1);
            border: 1px solid #deff01;
        }
        
        /* Prevent zoom on inputs */
        input[type="tel"], 
        input[type="text"], 
        input[type="number"], 
        select {
            font-size: 16px;
            transform: translateZ(0);
        }
        
        /* Smooth scrolling */
        html { 
            scroll-behavior: smooth; 
        }
        
        /* Logo styles */
        .logo-container {
            text-align: center;
            margin-bottom: 24px;
        }
        .logo-icon {
            width: 80px;
            height: 80px;
            background: #deff01;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            margin-bottom: 16px;
        }
        .logo-text {
            font-size: 36px;
            font-weight: bold;
            color: #deff01;
            letter-spacing: 2px;
        }
        .logo-tagline {
            font-size: 12px;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 4px;
        }
        
        /* Header styles */
        .header {
            background-color: #1a202c;
            color: white;
            padding: 12px 20px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .header-back {
            padding: 8px;
            background: transparent;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 4px;
            font-size: 20px;
            min-width: 40px;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .header-title {
            font-size: 18px;
            font-weight: bold;
            color: #deff01;
        }
        .header-spacer {
            width: 40px;
        }
    </style>
</head>
<body>
    <div id="root">
        <div style="display: flex; align-items: center; justify-content: center; min-height: 100vh; flex-direction: column;">
            <div class="logo-container">
                <div class="logo-icon">🏓</div>
                <div class="logo-text">DiNKR</div>
                <div class="logo-tagline">MEET YOUR MATCH</div>
            </div>
            <div class="spinner"></div>
            <p style="margin-top: 20px;">Loading Tournament System...</p>
        </div>
    </div>
    
    <script>
        // Enhanced error handling
        window.addEventListener('error', function(e) {
            console.error('Global error:', e.error);
            document.getElementById('root').innerHTML = `
                <div style="padding: 20px; text-align: center; background: #325682; color: white; min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                    <h2 style="color: #dc2626; margin-bottom: 20px;">⚠️ Loading Error</h2>
                    <p style="margin-bottom: 20px;">React components failed to load.</p>
                    <p style="font-size: 14px; color: #94a3b8;">Error: ${e.error ? e.error.message : 'Unknown error'}</p>
                    <button onclick="window.location.reload()" style="background: #deff01; color: #1a202c; border: none; padding: 12px 24px; border-radius: 8px; margin-top: 20px; cursor: pointer; font-weight: bold;">Reload Page</button>
                </div>
            `;
        });

        // Check if React loaded
        if (typeof React === 'undefined') {
            document.getElementById('root').innerHTML = `
                <div style="padding: 20px; text-align: center; background: #325682; color: white; min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                    <h2 style="color: #dc2626; margin-bottom: 20px;">React Loading Failed</h2>
                    <p style="margin-bottom: 20px;">CDN connection issue. Check internet.</p>
                    <button onclick="window.location.reload()" style="background: #deff01; color: #1a202c; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold;">Retry</button>
                </div>
            `;
        } else {
            // React loaded successfully, initialize app
            const { useState, useCallback, useEffect, createElement: h } = React;
            
            // Utility function for creating elements
            const createEl = (type, props = {}, ...children) => {
                try {
                    return h(type, props, ...children);
                } catch (error) {
                    console.error('Error creating element:', error);
                    return h('div', { style: { color: 'red' } }, 'Component Error');
                }
            };
            
            // Icon Components
            const ChevronLeft = () => createEl('span', { style: { fontSize: '20px' } }, '←');
            const CheckCircle = () => createEl('span', { style: { fontSize: '18px' } }, '✓');
            const Trophy = () => createEl('span', { style: { fontSize: '40px' } }, '🏆');
            
            // Logo Component
            const DiNKRLogo = ({ size = 'normal' }) => {
                const logoSize = size === 'large' ? 80 : 60;
                const textSize = size === 'large' ? '36px' : '28px';
                
                return createEl('div', { className: 'logo-container' }, [
                    createEl('div', { 
                        key: 'icon',
                        className: 'logo-icon',
                        style: { 
                            width: logoSize + 'px', 
                            height: logoSize + 'px',
                            fontSize: Math.round(logoSize * 0.5) + 'px'
                        } 
                    }, '🏓'),
                    createEl('div', { key: 'text' }, [
                        createEl('div', { 
                            key: 'title',
                            className: 'logo-text',
                            style: { fontSize: textSize }
                        }, 'DiNKR'),
                        createEl('div', { 
                            key: 'tagline',
                            className: 'logo-tagline' 
                        }, 'MEET YOUR MATCH')
                    ])
                ]);
            };
            
            // Number Input Component
            const NumberInput = ({ value, onChange, min = 1, max = 100, label, helpText }) => {
                const increment = () => value < max && onChange(value + 1);
                const decrement = () => value > min && onChange(value - 1);
                const handleInputChange = (e) => {
                    const newValue = parseInt(e.target.value) || min;
                    onChange(Math.max(min, Math.min(max, newValue)));
                };

                return createEl('div', { style: { marginBottom: '20px' } }, [
                    createEl('label', { 
                        key: 'label',
                        style: { 
                            display: 'block', 
                            fontSize: '16px', 
                            fontWeight: '500', 
                            marginBottom: '8px', 
                            color: 'white' 
                        } 
                    }, label),
                    createEl('div', { key: 'controls', className: 'number-input-container' }, [
                        createEl('button', {
                            key: 'dec',
                            onClick: decrement,
                            disabled: value <= min,
                            className: 'number-input-btn',
                            type: 'button'
                        }, '−'),
                        createEl('input', { 
                            key: 'input',
                            type: 'number', 
                            min, 
                            max, 
                            value, 
                            onChange: handleInputChange,
                            className: 'input', 
                            style: { 
                                width: '100px',
                                textAlign: 'center',
                                backgroundColor: 'rgba(255, 255, 255, 0.15)', 
                                border: '2px solid rgba(255, 255, 255, 0.3)', 
                                color: 'white'
                            } 
                        }),
                        createEl('button', {
                            key: 'inc',
                            onClick: increment,
                            disabled: value >= max,
                            className: 'number-input-btn',
                            type: 'button'
                        }, '+')
                    ]),
                    helpText ? createEl('p', { 
                        key: 'help',
                        style: { fontSize: '14px', color: '#94a3b8', marginTop: '6px' } 
                    }, helpText) : null
                ]);
            };

            // Score Validation Dialog
            const ScoreValidationDialog = ({ isOpen, onClose, teamAScore, teamBScore, onConfirm }) => {
                if (!isOpen) return null;

                return createEl('div', { className: 'dialog-overlay' }, [
                    createEl('div', { 
                        key: 'content',
                        className: 'dialog-content',
                        style: { maxWidth: '400px', textAlign: 'center' }
                    }, [
                        createEl('h2', { 
                            key: 'title',
                            style: { fontSize: '24px', fontWeight: 'bold', marginBottom: '16px', color: '#dc2626' } 
                        }, '⚠️ Score Confirmation'),
                        createEl('p', { 
                            key: 'message',
                            style: { marginBottom: '20px', fontSize: '16px', lineHeight: '1.5' } 
                        }, `Neither team scored 11 points (${teamAScore} - ${teamBScore}). Please confirm or edit.`),
                        createEl('div', { 
                            key: 'score',
                            style: {
                                backgroundColor: '#f8f9fa',
                                padding: '16px',
                                borderRadius: '8px',
                                marginBottom: '24px',
                                fontSize: '24px',
                                fontWeight: 'bold',
                                color: '#325682'
                            }
                        }, `${teamAScore} - ${teamBScore}`),
                        createEl('div', { 
                            key: 'buttons',
                            style: { display: 'flex', gap: '16px', justifyContent: 'center', flexWrap: 'wrap' }
                        }, [
                            createEl('button', {
                                key: 'edit',
                                onClick: onClose,
                                className: 'btn',
                                style: {
                                    backgroundColor: '#64748b',
                                    color: 'white',
                                    padding: '16px 24px',
                                    borderRadius: '8px',
                                    fontSize: '16px'
                                }
                            }, 'Edit Score'),
                            createEl('button', {
                                key: 'confirm',
                                onClick: onConfirm,
                                className: 'btn',
                                style: {
                                    backgroundColor: '#deff01',
                                    color: '#1a202c',
                                    padding: '16px 24px',
                                    borderRadius: '8px',
                                    fontSize: '16px'
                                }
                            }, 'Confirm Score')
                        ])
                    ])
                ]);
            };

            // Skip Player Dialog
            const SkipPlayerDialog = ({ isOpen, onClose, tournament, onSkipPlayersSelected, maxSkips }) => {
                const [selectedPlayers, setSelectedPlayers] = useState(new Set());

                useEffect(() => {
                    if (isOpen) {
                        setSelectedPlayers(new Set());
                    }
                }, [isOpen]);

                if (!isOpen || !tournament) return null;

                const togglePlayer = (playerName) => {
                    setSelectedPlayers(prev => {
                        const newSet = new Set(prev);
                        if (newSet.has(playerName)) {
                            newSet.delete(playerName);
                        } else if (newSet.size < maxSkips) {
                            newSet.add(playerName);
                        }
                        return newSet;
                    });
                };

                const handleNoSkips = () => {
                    onSkipPlayersSelected([]);
                    onClose();
                };

                const handleConfirmSkips = () => {
                    onSkipPlayersSelected(Array.from(selectedPlayers));
                    onClose();
                };

                return createEl('div', { className: 'dialog-overlay' }, [
                    createEl('div', { 
                        key: 'content',
                        className: 'dialog-content',
                        style: { maxWidth: '500px', textAlign: 'center' }
                    }, [
                        createEl('h2', { 
                            key: 'title',
                            style: { fontSize: '24px', fontWeight: 'bold', marginBottom: '16px', color: '#325682' } 
                        }, 'Next Round Setup'),
                        createEl('p', { 
                            key: 'question',
                            style: { marginBottom: '24px', fontSize: '18px' } 
                        }, 'Do any players need to skip the next round?'),
                        createEl('div', { 
                            key: 'instructions',
                            style: { marginBottom: '20px', fontSize: '14px', color: '#64748b' }
                        }, `Select up to ${maxSkips} player${maxSkips !== 1 ? 's' : ''} to skip:`),
                        createEl('div', { 
                            key: 'players',
                            className: 'player-grid'
                        }, tournament.players.map(player => {
                            const playerName = player.name || player.firstName;
                            const isSelected = selectedPlayers.has(playerName);
                            const canSelect = selectedPlayers.size < maxSkips || isSelected;
                            
                            return createEl('button', {
                                key: playerName,
                                onClick: () => togglePlayer(playerName),
                                disabled: !canSelect,
                                className: `player-button ${isSelected ? 'selected' : ''}`,
                                style: {
                                    border: `2px solid ${isSelected ? '#325682' : '#e2e8f0'}`,
                                    backgroundColor: isSelected ? '#deff01' : (canSelect ? 'white' : '#f8f9fa'),
                                    color: isSelected ? '#1a202c' : (canSelect ? '#1a202c' : '#9ca3af'),
                                    cursor: canSelect ? 'pointer' : 'not-allowed'
                                }
                            }, playerName);
                        })),
                        selectedPlayers.size > 0 ? createEl('p', {
                            key: 'selected-count',
                            style: { fontSize: '14px', color: '#325682', marginBottom: '20px' }
                        }, `${selectedPlayers.size} player${selectedPlayers.size !== 1 ? 's' : ''} selected to skip`) : null,
                        createEl('div', { 
                            key: 'buttons',
                            style: { display: 'flex', gap: '16px', justifyContent: 'center', flexWrap: 'wrap' }
                        }, [
                            createEl('button', {
                                key: 'no-skips',
                                onClick: handleNoSkips,
                                className: 'btn',
                                style: {
                                    backgroundColor: '#64748b',
                                    color: 'white',
                                    padding: '16px 24px',
                                    borderRadius: '8px',
                                    fontSize: '16px'
                                }
                            }, 'No Skips'),
                            createEl('button', {
                                key: 'confirm',
                                onClick: handleConfirmSkips,
                                disabled: selectedPlayers.size === 0,
                                className: 'btn',
                                style: {
                                    backgroundColor: selectedPlayers.size > 0 ? '#deff01' : '#9ca3af',
                                    color: '#1a202c',
                                    padding: '16px 24px',
                                    borderRadius: '8px',
                                    fontSize: '16px',
                                    cursor: selectedPlayers.size > 0 ? 'pointer' : 'not-allowed'
                                }
                            }, 'Confirm Skips')
                        ])
                    ])
                ]);
            };

            // Player Management Dialog
            const PlayerDialog = ({ isOpen, onClose, players, setPlayers, totalPlayers }) => {
                const [editingPlayers, setEditingPlayers] = useState([]);

                useEffect(() => {
                    if (isOpen) {
                        // Initialize with current players or create new ones
                        const initialPlayers = [];
                        for (let i = 0; i < totalPlayers; i++) {
                            if (players[i]) {
                                initialPlayers.push(players[i]);
                            } else {
                                initialPlayers.push({
                                    firstName: '',
                                    lastName: '',
                                    gender: 'M',
                                    rating: 3.5
                                });
                            }
                        }
                        setEditingPlayers(initialPlayers);
                    }
                }, [isOpen, players, totalPlayers]);

                const updatePlayer = (index, field, value) => {
                    setEditingPlayers(prev => {
                        const updated = [...prev];
                        updated[index] = { ...updated[index], [field]: value };
                        return updated;
                    });
                };

                const handleSave = () => {
                    // Validate all players have first names
                    const allValid = editingPlayers.every(p => p.firstName.trim());
                    if (!allValid) {
                        alert('Please fill in all first names');
                        return;
                    }
                    
                    setPlayers(editingPlayers);
                    onClose();
                };

                const randomizeRatings = () => {
                    setEditingPlayers(prev => prev.map(p => ({
                        ...p,
                        rating: Math.round((Math.random() * 1.5 + 3.0) * 10) / 10
                    })));
                };

                if (!isOpen) return null;

                return createEl('div', { className: 'dialog-overlay' }, [
                    createEl('div', { 
                        key: 'content',
                        className: 'dialog-content',
                        style: { maxWidth: '600px' }
                    }, [
                        createEl('div', { 
                            key: 'header',
                            style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }
                        }, [
                            createEl('h2', { 
                                key: 'title',
                                style: { fontSize: '24px', fontWeight: 'bold', color: '#325682' } 
                            }, 'Configure Players'),
                            createEl('button', {
                                key: 'randomize',
                                onClick: randomizeRatings,
                                className: 'btn',
                                style: {
                                    backgroundColor: '#deff01',
                                    color: '#1a202c',
                                    padding: '8px 16px',
                                    borderRadius: '6px',
                                    fontSize: '14px'
                                }
                            }, 'Randomize Ratings')
                        ]),
                        
                        createEl('div', { 
                            key: 'players',
                            style: { marginBottom: '24px', maxHeight: '400px', overflowY: 'auto' }
                        }, editingPlayers.map((player, index) => 
                            createEl('div', {
                                key: index,
                                style: {
                                    display: 'grid',
                                    gridTemplateColumns: '1fr 1fr 80px 80px',
                                    gap: '12px',
                                    marginBottom: '12px',
                                    padding: '12px',
                                    backgroundColor: '#f8f9fa',
                                    borderRadius: '8px'
                                }
                            }, [
                                createEl('input', {
                                    key: 'firstName',
                                    type: 'text',
                                    placeholder: 'First Name',
                                    value: player.firstName,
                                    onChange: (e) => updatePlayer(index, 'firstName', e.target.value),
                                    style: {
                                        padding: '8px 12px',
                                        border: '2px solid #e2e8f0',
                                        borderRadius: '6px',
                                        fontSize: '14px'
                                    }
                                }),
                                createEl('input', {
                                    key: 'lastName',
                                    type: 'text',
                                    placeholder: 'Last Name',
                                    value: player.lastName,
                                    onChange: (e) => updatePlayer(index, 'lastName', e.target.value),
                                    style: {
                                        padding: '8px 12px',
                                        border: '2px solid #e2e8f0',
                                        borderRadius: '6px',
                                        fontSize: '14px'
                                    }
                                }),
                                createEl('select', {
                                    key: 'gender',
                                    value: player.gender,
                                    onChange: (e) => updatePlayer(index, 'gender', e.target.value),
                                    style: {
                                        padding: '8px 12px',
                                        border: '2px solid #e2e8f0',
                                        borderRadius: '6px',
                                        fontSize: '14px'
                                    }
                                }, [
                                    createEl('option', { key: 'M', value: 'M' }, 'Male'),
                                    createEl('option', { key: 'F', value: 'F' }, 'Female')
                                ]),
                                createEl('input', {
                                    key: 'rating',
                                    type: 'number',
                                    min: 2.0,
                                    max: 5.0,
                                    step: 0.1,
                                    value: player.rating,
                                    onChange: (e) => updatePlayer(index, 'rating', parseFloat(e.target.value) || 3.5),
                                    style: {
                                        padding: '8px 12px',
                                        border: '2px solid #e2e8f0',
                                        borderRadius: '6px',
                                        fontSize: '14px'
                                    }
                                })
                            ])
                        )),
                        
                        createEl('div', { 
                            key: 'buttons',
                            style: { display: 'flex', gap: '12px', justifyContent: 'flex-end' }
                        }, [
                            createEl('button', {
                                key: 'cancel',
                                onClick: onClose,
                                className: 'btn',
                                style: {
                                    backgroundColor: '#64748b',
                                    color: 'white',
                                    padding: '12px 24px',
                                    borderRadius: '8px',
                                    fontSize: '16px'
                                }
                            }, 'Cancel'),
                            createEl('button', {
                                key: 'save',
                                onClick: handleSave,
                                className: 'btn',
                                style: {
                                    backgroundColor: '#deff01',
                                    color: '#1a202c',
                                    padding: '12px 24px',
                                    borderRadius: '8px',
                                    fontSize: '16px'
                                }
                            }, 'Save Players')
                        ])
                    ])
                ]);
            };

            // Player Switch Dialog
            const PlayerSwitchDialog = ({ isOpen, onClose, tournament, currentRound, onSwitchesConfirmed }) => {
                const [switches, setSwitches] = useState([]);

                useEffect(() => {
                    if (isOpen) {
                        setSwitches([]);
                    }
                }, [isOpen]);

                if (!isOpen || !tournament) return null;

                const currentMatches = tournament.schedule[currentRound]?.matches || [];
                const allPlayers = tournament.players;

                const addSwitch = (oldPlayer, newPlayer) => {
                    setSwitches(prev => {
                        const filtered = prev.filter(s => s.oldPlayer !== oldPlayer);
                        return [...filtered, { oldPlayer, newPlayer }];
                    });
                };

                const removeSwitch = (oldPlayer) => {
                    setSwitches(prev => prev.filter(s => s.oldPlayer !== oldPlayer));
                };

                const handlePlayerClick = (player) => {
                    const availablePlayerNames = allPlayers
                        .map(p => p.name || `${p.firstName} ${p.lastName}`.trim())
                        .filter(name => name !== player.name)
                        .sort();
                    
                    const playerList = availablePlayerNames.join(', ');
                    const newPlayerName = prompt(
                        `Replace ${player.name} with:\n\nAvailable players: ${playerList}`, 
                        ''
                    );
                    
                    if (newPlayerName) {
                        const foundPlayer = allPlayers.find(p => {
                            const pName = p.name || `${p.firstName} ${p.lastName}`.trim();
                            return pName.toLowerCase() === newPlayerName.toLowerCase();
                        });
                        
                        if (foundPlayer) {
                            const foundPlayerName = foundPlayer.name || `${foundPlayer.firstName} ${foundPlayer.lastName}`.trim();
                            addSwitch(player.name, foundPlayerName);
                        } else {
                            alert(`Player "${newPlayerName}" not found. Please check spelling.`);
                        }
                    }
                };

                const handleConfirm = () => {
                    onSwitchesConfirmed(switches);
                    onClose();
                };

                return createEl('div', { className: 'dialog-overlay' }, [
                    createEl('div', { 
                        key: 'content',
                        className: 'dialog-content',
                        style: { maxWidth: '600px', textAlign: 'center' }
                    }, [
                        createEl('h2', { 
                            key: 'title',
                            style: { fontSize: '24px', fontWeight: 'bold', marginBottom: '16px', color: '#325682' } 
                        }, 'Manual Player Assignments'),
                        createEl('p', { 
                            key: 'description',
                            style: { marginBottom: '24px', fontSize: '16px', color: '#64748b' } 
                        }, 'Click on any player name to replace them with a different player.'),
                        
                        // Show current matches with clickable players
                        createEl('div', { 
                            key: 'matches',
                            style: { marginBottom: '24px' }
                        }, currentMatches.map((match, matchIndex) => {
                            const [teamA, teamB] = match;
                            return createEl('div', {
                                key: matchIndex,
                                className: 'match-display'
                            }, [
                                createEl('h4', { 
                                    key: 'court-title',
                                    style: { marginBottom: '12px', color: '#325682' } 
                                }, `Court ${matchIndex + 1}`),
                                createEl('div', {
                                    key: 'teams',
                                    style: { display: 'flex', justifyContent: 'space-around', alignItems: 'center', flexWrap: 'wrap' }
                                }, [
                                    createEl('div', { key: 'teamA', className: 'team-display' }, [
                                        createEl('div', { 
                                            key: 'team-label',
                                            className: 'team-label'
                                        }, 'Team A'),
                                        ...teamA.map((player, playerIndex) => 
                                            createEl('div', {
                                                key: `a-${playerIndex}`,
                                                className: 'player-chip',
                                                onClick: () => handlePlayerClick(player)
                                            }, player.name)
                                        )
                                    ]),
                                    createEl('div', { 
                                        key: 'vs',
                                        style: { 
                                            fontSize: '18px', 
                                            fontWeight: 'bold', 
                                            color: '#325682',
                                            margin: '0 16px'
                                        } 
                                    }, 'VS'),
                                    createEl('div', { key: 'teamB', className: 'team-display' }, [
                                        createEl('div', { 
                                            key: 'team-label',
                                            className: 'team-label'
                                        }, 'Team B'),
                                        ...teamB.map((player, playerIndex) => 
                                            createEl('div', {
                                                key: `b-${playerIndex}`,
                                                className: 'player-chip',
                                                onClick: () => handlePlayerClick(player)
                                            }, player.name)
                                        )
                                    ])
                                ])
                            ]);
                        })),
                        
                        // Show pending switches
                        switches.length > 0 ? createEl('div', {
                            key: 'pending-switches',
                            style: {
                                backgroundColor: '#f0f9ff',
                                border: '2px solid #325682',
                                borderRadius: '8px',
                                padding: '16px',
                                marginBottom: '24px'
                            }
                        }, [
                            createEl('h4', { 
                                key: 'switches-title',
                                style: { marginBottom: '12px', color: '#325682' } 
                            }, 'Pending Switches:'),
                            ...switches.map((switchItem, index) => 
                                createEl('div', {
                                    key: index,
                                    style: {
                                        display: 'flex',
                                        justifyContent: 'space-between',
                                        alignItems: 'center',
                                        padding: '8px',
                                        backgroundColor: 'white',
                                        borderRadius: '4px',
                                        marginBottom: '8px'
                                    }
                                }, [
                                    createEl('span', { key: 'switch-text' }, `${switchItem.oldPlayer} → ${switchItem.newPlayer}`),
                                    createEl('button', {
                                        key: 'remove-switch',
                                        onClick: () => removeSwitch(switchItem.oldPlayer),
                                        style: {
                                            background: '#dc2626',
                                            color: 'white',
                                            border: 'none',
                                            borderRadius: '4px',
                                            padding: '4px 8px',
                                            cursor: 'pointer',
                                            fontSize: '12px'
                                        }
                                    }, '✕')
                                ])
                            )
                        ]) : null,
                        
                        createEl('div', { 
                            key: 'buttons',
                            style: { display: 'flex', gap: '16px', justifyContent: 'center', flexWrap: 'wrap' }
                        }, [
                            createEl('button', {
                                key: 'no-changes',
                                onClick: () => { setSwitches([]); handleConfirm(); },
                                className: 'btn',
                                style: {
                                    backgroundColor: '#64748b',
                                    color: 'white',
                                    padding: '16px 24px',
                                    borderRadius: '8px',
                                    fontSize: '16px'
                                }
                            }, 'Keep Auto Assignments'),
                            createEl('button', {
                                key: 'confirm',
                                onClick: handleConfirm,
                                className: 'btn',
                                style: {
                                    backgroundColor: '#deff01',
                                    color: '#1a202c',
                                    padding: '16px 24px',
                                    borderRadius: '8px',
                                    fontSize: '16px'
                                }
                            }, switches.length > 0 ? `Apply ${switches.length} Switch${switches.length !== 1 ? 'es' : ''}` : 'Confirm Assignments')
                        ])
                    ])
                ]);
            };

            // Court Component
            const Court = ({ match, matchIndex, roundIndex, courtNumber, scores, updateScore, onScoreValidation, roundStarted = true }) => {
                const [teamA, teamB] = match;
                const matchScores = scores[roundIndex]?.[matchIndex] || { teamA: '', teamB: '' };

                const handleScoreChange = (team, value) => {
                    if (!roundStarted) return;
                    updateScore(roundIndex, matchIndex, team, value);
                    
                    // Score validation logic
                    const otherTeam = team === 'teamA' ? 'teamB' : 'teamA';
                    const otherScore = team === 'teamA' ? matchScores.teamB : matchScores.teamA;
                    const currentTeamAScore = team === 'teamA' ? value : otherScore;
                    const currentTeamBScore = team === 'teamB' ? value : otherScore;
                    
                    if (currentTeamAScore && currentTeamBScore) {
                        const scoreA = parseInt(currentTeamAScore) || 0;
                        const scoreB = parseInt(currentTeamBScore) || 0;
                        
                        if ((scoreA >= 10 || scoreB >= 10) && scoreA < 11 && scoreB < 11 && (scoreA > 0 || scoreB > 0)) {
                            setTimeout(() => {
                                const finalA = parseInt(scores[roundIndex]?.[matchIndex]?.teamA) || 0;
                                const finalB = parseInt(scores[roundIndex]?.[matchIndex]?.teamB) || 0;
                                if (finalA < 11 && finalB < 11 && (finalA > 0 || finalB > 0)) {
                                    onScoreValidation(roundIndex, matchIndex, finalA, finalB);
                                }
                            }, 1000);
                        }
                    }
                };

                const renderPlayer = (player, position) => {
                    return createEl('div', {
                        key: `player-${position}`,
                        className: `court-player ${position === 0 ? 'top' : ''}`,
                    }, player.firstName || player.name);
                };

                return createEl('div', { className: 'court-wrapper' }, [
                    createEl('div', { key: 'top-post', style: { display: 'flex', justifyContent: 'center', marginBottom: '4px' } },
                        createEl('div', { style: { width: '8px', height: '16px', backgroundColor: '#000' } })
                    ),
                    createEl('div', { key: 'court', className: 'court-container' }, [
                        createEl('div', { 
                            key: 'left-team', 
                            className: 'court-team left'
                        }, [
                            renderPlayer(teamA[0], 0),
                            renderPlayer(teamA[1], 1)
                        ]),
                        createEl('div', { 
                            key: 'left-score', 
                            style: { backgroundColor: '#a0aec0', display: 'flex', alignItems: 'center', justifyContent: 'center' } 
                        },
                            createEl('input', {
                                type: 'tel',
                                inputMode: 'numeric',
                                value: matchScores.teamA,
                                disabled: !roundStarted,
                                onChange: (e) => {
                                    const value = e.target.value.replace(/[^0-9]/g, '');
                                    const numValue = parseInt(value) || 0;
                                    if (value === '' || numValue <= 15) {
                                        handleScoreChange('teamA', value);
                                    }
                                },
                                onFocus: (e) => e.target.select(),
                                className: 'court-score-input',
                                placeholder: roundStarted ? '0' : '—'
                            })
                        ),
                        createEl('div', { key: 'net', style: { backgroundColor: '#000' } }),
                        createEl('div', { 
                            key: 'right-score', 
                            style: { backgroundColor: '#a0aec0', display: 'flex', alignItems: 'center', justifyContent: 'center' } 
                        },
                            createEl('input', {
                                type: 'tel',
                                inputMode: 'numeric',
                                value: matchScores.teamB,
                                disabled: !roundStarted,
                                onChange: (e) => {
                                    const value = e.target.value.replace(/[^0-9]/g, '');
                                    const numValue = parseInt(value) || 0;
                                    if (value === '' || numValue <= 15) {
                                        handleScoreChange('teamB', value);
                                    }
                                },
                                onFocus: (e) => e.target.select(),
                                className: 'court-score-input',
                                placeholder: roundStarted ? '0' : '—'
                            })
                        ),
                        createEl('div', { 
                            key: 'right-team', 
                            className: 'court-team right'
                        }, [
                            renderPlayer(teamB[0], 0),
                            renderPlayer(teamB[1], 1)
                        ])
                    ]),
                    createEl('div', { key: 'bottom-post', style: { display: 'flex', justifyContent: 'center', marginTop: '4px' } },
                        createEl('div', { style: { width: '8px', height: '16px', backgroundColor: '#000' } })
                    ),
                    createEl('div', { 
                        key: 'court-number', 
                        style: { textAlign: 'center', marginTop: '12px' } 
                    },
                        createEl('span', { 
                            style: { 
                                backgroundColor: '#deff01', 
                                color: '#1a202c', 
                                fontWeight: 'bold', 
                                padding: '8px 16px', 
                                fontSize: '18px', 
                                borderRadius: '4px' 
                            } 
                        }, `Court ${courtNumber}`)
                    )
                ]);
            };

            // Main Tournament App
            const TournamentApp = () => {
                const [step, setStep] = useState(1);
                const [config, setConfig] = useState({
                    courts: 2, 
                    totalPlayers: 8, 
                    rounds: 6, 
                    useDefaults: true,
                    avoidMMvsFF: true, 
                    useRatingBalance: true, 
                    roundDuration: 13
                });
                const [players, setPlayers] = useState([]);
                const [showPlayerDialog, setShowPlayerDialog] = useState(false);
                const [tournament, setTournament] = useState(null);
                const [currentRound, setCurrentRound] = useState(0);
                const [scores, setScores] = useState({});
                const [phase, setPhase] = useState('setup');
                const [roundStarted, setRoundStarted] = useState(false);
                const [timeRemaining, setTimeRemaining] = useState(0);
                const [timerRunning, setTimerRunning] = useState(false);
                const [loading, setLoading] = useState(false);
                const [errorMessage, setErrorMessage] = useState('');
                const [successMessage, setSuccessMessage] = useState('');
                const [showSkipDialog, setShowSkipDialog] = useState(false);
                const [showSwitchDialog, setShowSwitchDialog] = useState(false);
                const [pendingSkipPlayers, setPendingSkipPlayers] = useState([]);
                
                // Score validation state
                const [scoreValidation, setScoreValidation] = useState({
                    isOpen: false,
                    roundIndex: null,
                    matchIndex: null,
                    teamAScore: null,
                    teamBScore: null
                });

                // Timer effect
                useEffect(() => {
                    let interval;
                    if (timerRunning && timeRemaining > 0) {
                        interval = setInterval(() => {
                            setTimeRemaining(prev => {
                                if (prev <= 1) {
                                    setTimerRunning(false);
                                    return 0;
                                }
                                return prev - 1;
                            });
                        }, 1000);
                    }
                    return () => clearInterval(interval);
                }, [timerRunning, timeRemaining]);

                const showError = (message) => {
                    setErrorMessage(message);
                    setTimeout(() => setErrorMessage(''), 5000);
                };

                const showSuccess = (message) => {
                    setSuccessMessage(message);
                    setTimeout(() => setSuccessMessage(''), 3000);
                };

                const generateTournament = async () => {
                    setLoading(true);
                    setErrorMessage('');
                    
                    try {
                        // Prepare players data
                        let playersToSend = [];
                        if (!config.useDefaults) {
                            // Convert custom players to format expected by backend
                            playersToSend = players.map(p => ({
                                name: `${p.firstName} ${p.lastName}`.trim(),
                                firstName: p.firstName,
                                lastName: p.lastName,
                                gender: p.gender,
                                rating: p.rating
                            }));
                        }

                        const requestData = {
                            courts: config.courts,
                            players: playersToSend,
                            rounds: config.rounds,
                            useDefaults: config.useDefaults,
                            avoidMMvsFF: config.avoidMMvsFF,
                            useRatingBalance: config.useRatingBalance,
                            ratingFactor: 3,
                            roundDuration: config.roundDuration,
                            totalPlayers: config.totalPlayers
                        };

                        const response = await fetch('/api/generate_tournament', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(requestData)
                        });

                        const result = await response.json();

                        if (response.ok && result.success) {
                            setTournament(result);
                            setCurrentRound(0);
                            setScores({});
                            setPhase('setup');
                            showSuccess('Tournament generated! Review Round 1 assignments.');
                            setStep(3);
                        } else {
                            showError(result.error || 'Failed to generate tournament');
                        }
                    } catch (error) {
                        showError('Network error: ' + error.message);
                    } finally {
                        setLoading(false);
                    }
                };

                const updateScore = async (roundIndex, matchIndex, team, score) => {
                    try {
                        const response = await fetch('/api/update_score', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ roundIndex, matchIndex, team, score })
                        });

                        if (response.ok) {
                            setScores(prev => ({
                                ...prev,
                                [roundIndex]: {
                                    ...prev[roundIndex],
                                    [matchIndex]: { 
                                        ...prev[roundIndex]?.[matchIndex], 
                                        [team]: score 
                                    }
                                }
                            }));
                        }
                    } catch (error) {
                        showError('Failed to update score');
                    }
                };

                const handleScoreValidation = (roundIndex, matchIndex, teamAScore, teamBScore) => {
                    setScoreValidation({
                        isOpen: true,
                        roundIndex,
                        matchIndex,
                        teamAScore,
                        teamBScore
                    });
                };

                const confirmScore = () => {
                    setScoreValidation({
                        isOpen: false,
                        roundIndex: null,
                        matchIndex: null,
                        teamAScore: null,
                        teamBScore: null
                    });
                };

                const isRoundComplete = (roundIndex) => {
                    if (!tournament || !scores[roundIndex]) return false;
                    const roundMatches = tournament.schedule[roundIndex]?.matches || [];
                    return roundMatches.every((match, matchIndex) => {
                        const matchScores = scores[roundIndex][matchIndex];
                        return matchScores && matchScores.teamA && matchScores.teamB;
                    });
                };

                const startRound = () => {
                    setRoundStarted(true);
                    setTimeRemaining(config.roundDuration * 60);
                    setTimerRunning(true);
                    setPhase('playing');
                };

                const handleAdvanceRound = () => {
                    if (currentRound < tournament.schedule.length - 1) {
                        const totalPlayers = tournament.players.length;
                        const playingPlayers = config.courts * 4;
                        const maxSkips = totalPlayers - playingPlayers;
                        
                        if (maxSkips > 0) {
                            setShowSkipDialog(true);
                        } else {
                            setShowSwitchDialog(true);
                        }
                    } else {
                        setPhase('completed');
                    }
                };

                const handleSkipPlayersSelected = (skipPlayers) => {
                    setPendingSkipPlayers(skipPlayers);
                    setShowSwitchDialog(true);
                };

                const handleSwitchesConfirmed = (switches) => {
                    if (phase === 'setup') {
                        applyRound1Switches(switches);
                    } else {
                        advanceRound(pendingSkipPlayers, switches);
                    }
                };

                const applyRound1Switches = async (switches) => {
                    try {
                        if (switches.length > 0) {
                            setLoading(true);
                            
                            const response = await fetch('/api/apply_player_switches', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({ switches, roundIndex: 0 })
                            });

                            const result = await response.json();

                            if (response.ok && result.success) {
                                const stateResponse = await fetch('/api/get_tournament_state');
                                const state = await stateResponse.json();
                                
                                if (state.tournament) {
                                    setTournament(state.tournament);
                                }
                                
                                showSuccess(`Applied ${switches.length} manual assignment(s) for Round 1`);
                            } else {
                                showError(result.error || 'Failed to apply switches');
                            }
                        }
                        
                        setPhase('playing');
                        setRoundStarted(true);
                        setTimeRemaining(config.roundDuration * 60);
                        setTimerRunning(true);
                    } catch (error) {
                        showError('Network error: ' + error.message);
                    } finally {
                        setLoading(false);
                    }
                };

                const advanceRound = async (skipPlayers = [], playerSwitches = []) => {
                    try {
                        setLoading(true);
                        
                        const response = await fetch('/api/advance_round', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ skipPlayers, playerSwitches })
                        });

                        const result = await response.json();

                        if (result.completed) {
                            setPhase('completed');
                        } else if (result.success) {
                            const stateResponse = await fetch('/api/get_tournament_state');
                            const state = await stateResponse.json();
                            
                            if (state.tournament) {
                                setTournament(state.tournament);
                                setCurrentRound(state.current_round);
                                setScores(state.scores);
                            }
                            
                            setRoundStarted(false);
                            setTimerRunning(false);
                            setTimeRemaining(0);
                            setPhase('playing');
                            
                            let message = `Advanced to Round ${result.round + 1}`;
                            if (skipPlayers.length > 0) {
                                message += ` with ${skipPlayers.length} player(s) skipping`;
                            }
                            if (playerSwitches.length > 0) {
                                message += ` and ${playerSwitches.length} manual assignment(s)`;
                            }
                            showSuccess(message);
                        } else {
                            showError(result.error || 'Failed to advance round');
                        }
                    } catch (error) {
                        showError('Network error: ' + error.message);
                    } finally {
                        setLoading(false);
                    }
                };

                const calculateTournamentResults = async () => {
                    try {
                        const response = await fetch('/api/calculate_results');
                        const results = await response.json();
                        
                        if (results.error) {
                            showError('Failed to calculate results');
                            return null;
                        }
                        
                        return results.map(player => {
                            const avgScore = player.matchesPlayed > 0 ? player.totalScore / player.matchesPlayed : 0;
                            const winRate = player.matchesPlayed > 0 ? (player.wins / player.matchesPlayed) * 100 : 0;
                            const expectedAvgScore = Math.max(6, Math.min(11, 5 + (player.rating - 3.0) * 2));
                            const performanceIndex = avgScore / expectedAvgScore;
                            
                            return {
                                ...player,
                                avgScore: Math.round(avgScore * 10) / 10,
                                winRate: Math.round(winRate),
                                expectedAvgScore: Math.round(expectedAvgScore * 10) / 10,
                                performanceIndex: Math.round(performanceIndex * 100) / 100,
                                performanceLabel: performanceIndex > 1.1 ? 'Exceeded' : 
                                                performanceIndex < 0.9 ? 'Below' : 'Met'
                            };
                        });
                    } catch (error) {
                        showError('Network error calculating results');
                        return null;
                    }
                };

                const formatTime = (seconds) => {
                    const mins = Math.floor(seconds / 60);
                    const secs = seconds % 60;
                    return `${mins}:${secs.toString().padStart(2, '0')}`;
                };

                const isLastMinute = timeRemaining <= 60 && timeRemaining > 0;

                // Step 1: Configuration
                if (step === 1) {
                    return createEl('div', { 
                        style: { 
                            minHeight: '100vh', 
                            background: '#325682', 
                            color: 'white',
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center',
                            padding: '24px'
                        } 
                    }, [
                        createEl('div', { key: 'container', className: 'container' }, [
                            createEl(DiNKRLogo, { key: 'logo' }),
                            
                            errorMessage ? createEl('div', { key: 'error', className: 'error-message' }, errorMessage) : null,
                            successMessage ? createEl('div', { key: 'success', className: 'success-message' }, successMessage) : null,
                            
                            createEl('div', { key: 'config', className: 'card' }, [
                                createEl('h3', { 
                                    key: 'title', 
                                    style: { 
                                        fontSize: '20px', 
                                        fontWeight: '600', 
                                        marginBottom: '20px', 
                                        color: '#deff01', 
                                        textAlign: 'center' 
                                    } 
                                }, 'Tournament Configuration'),
                                createEl('div', { 
                                    key: 'fields', 
                                    style: { display: 'flex', flexDirection: 'column', gap: '20px' } 
                                }, [
                                    createEl(NumberInput, {
                                        key: 'courts',
                                        value: config.courts,
                                        onChange: (value) => setConfig(prev => ({...prev, courts: value})),
                                        min: 1,
                                        max: 10,
                                        label: 'Number of Courts'
                                    }),
                                    createEl(NumberInput, {
                                        key: 'players',
                                        value: config.totalPlayers,
                                        onChange: (value) => setConfig(prev => ({...prev, totalPlayers: value})),
                                        min: 4,
                                        max: 100,
                                        label: 'Number of Players',
                                        helpText: `${config.courts * 4} will play each round.`
                                    }),
                                    createEl(NumberInput, {
                                        key: 'rounds',
                                        value: config.rounds,
                                        onChange: (value) => setConfig(prev => ({...prev, rounds: value})),
                                        min: 3,
                                        max: 15,
                                        label: 'Number of Rounds'
                                    }),
                                    createEl(NumberInput, {
                                        key: 'duration',
                                        value: config.roundDuration,
                                        onChange: (value) => setConfig(prev => ({...prev, roundDuration: value})),
                                        min: 10,
                                        max: 15,
                                        label: 'Round Duration (minutes)',
                                        helpText: 'Range: 10-15 minutes (default: 13)'
                                    })
                                ])
                            ]),
                            
                            // Advanced Options
                            createEl('div', { key: 'advanced', className: 'card' }, [
                                createEl('h3', { 
                                    key: 'title', 
                                    style: { 
                                        fontSize: '18px', 
                                        fontWeight: '600', 
                                        marginBottom: '16px', 
                                        color: '#deff01', 
                                        textAlign: 'center' 
                                    } 
                                }, 'Advanced Options'),
                                createEl('div', { 
                                    key: 'options',
                                    style: { display: 'flex', flexDirection: 'column', gap: '16px' }
                                }, [
                                    createEl('label', { 
                                        key: 'gender', 
                                        style: { 
                                            display: 'flex', 
                                            alignItems: 'center', 
                                            gap: '12px', 
                                            cursor: 'pointer' 
                                        } 
                                    }, [
                                        createEl('input', { 
                                            type: 'checkbox',
                                            checked: config.avoidMMvsFF, 
                                            onChange: (e) => setConfig(prev => ({...prev, avoidMMvsFF: e.target.checked})), 
                                            style: { width: '18px', height: '18px' } 
                                        }),
                                        createEl('span', { style: { fontSize: '14px' } }, 'Avoid Male vs Female matchups when possible')
                                    ]),
                                    createEl('label', { 
                                        key: 'rating', 
                                        style: { 
                                            display: 'flex', 
                                            alignItems: 'center', 
                                            gap: '12px', 
                                            cursor: 'pointer' 
                                        } 
                                    }, [
                                        createEl('input', { 
                                            type: 'checkbox',
                                            checked: config.useRatingBalance, 
                                            onChange: (e) => setConfig(prev => ({...prev, useRatingBalance: e.target.checked})), 
                                            style: { width: '18px', height: '18px' } 
                                        }),
                                        createEl('span', { style: { fontSize: '14px' } }, 'Create balanced teams based on player ratings')
                                    ])
                                ])
                            ]),
                            
                            loading ? createEl('div', { key: 'loading', className: 'spinner' }) : null,
                            
                            createEl('button', { 
                                key: 'next', 
                                onClick: () => setStep(2), 
                                disabled: loading, 
                                className: 'btn', 
                                style: { 
                                    width: '100%', 
                                    backgroundColor: loading ? '#64748b' : '#deff01', 
                                    color: '#1e293b', 
                                    padding: '18px', 
                                    fontSize: '18px',
                                    fontWeight: 'bold',
                                    borderRadius: '12px'
                                } 
                            }, 'Next: Configure Players')
                        ])
                    ]);
                }

                // Step 2: Player Configuration
                if (step === 2) {
                    return createEl('div', { 
                        style: { 
                            minHeight: '100vh', 
                            background: '#325682', 
                            color: 'white', 
                            padding: '20px',
                            display: 'flex',
                            flexDirection: 'column',
                            alignItems: 'center'
                        } 
                    }, [
                        createEl('div', { key: 'container', className: 'container' }, [
                            createEl('div', { 
                                key: 'header', 
                                style: { display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '24px' } 
                            }, [
                                createEl('button', { 
                                    key: 'back', 
                                    onClick: () => setStep(1), 
                                    className: 'header-back'
                                }, createEl(ChevronLeft)),
                                createEl('h2', { 
                                    key: 'title', 
                                    style: { fontSize: '24px', fontWeight: 'bold', color: '#deff01' } 
                                }, 'Player Configuration'),
                                createEl('div', { key: 'spacer', style: { width: '40px' } })
                            ]),
                            
                            errorMessage ? createEl('div', { key: 'error', className: 'error-message' }, errorMessage) : null,
                            successMessage ? createEl('div', { key: 'success', className: 'success-message' }, successMessage) : null,
                            
                            createEl('div', { key: 'player-options', className: 'card' }, [
                                createEl('h3', { 
                                    key: 'title', 
                                    style: { marginBottom: '20px', color: '#deff01', fontSize: '20px', textAlign: 'center' } 
                                }, 'Player Setup'),
                                createEl('div', { 
                                    key: 'options',
                                    style: { display: 'flex', flexDirection: 'column', gap: '16px' }
                                }, [
                                    createEl('label', { 
                                        key: 'defaults', 
                                        style: { display: 'flex', alignItems: 'center', gap: '12px', cursor: 'pointer' } 
                                    }, [
                                        createEl('input', { 
                                            type: 'radio', 
                                            name: 'playerType',
                                            checked: config.useDefaults, 
                                            onChange: () => setConfig(prev => ({...prev, useDefaults: true})), 
                                            style: { width: '20px', height: '20px' } 
                                        }),
                                        createEl('span', { style: { fontSize: '16px' } }, 'Use default players with balanced ratings')
                                    ]),
                                    createEl('label', { 
                                        key: 'custom', 
                                        style: { display: 'flex', alignItems: 'center', gap: '12px', cursor: 'pointer' } 
                                    }, [
                                        createEl('input', { 
                                            type: 'radio', 
                                            name: 'playerType',
                                            checked: !config.useDefaults, 
                                            onChange: () => setConfig(prev => ({...prev, useDefaults: false})), 
                                            style: { width: '20px', height: '20px' } 
                                        }),
                                        createEl('span', { style: { fontSize: '16px' } }, 'Add custom players')
                                    ])
                                ]),
                                
                                !config.useDefaults ? createEl('div', { 
                                    key: 'custom-controls',
                                    style: { marginTop: '20px', textAlign: 'center' }
                                }, [
                                    createEl('button', {
                                        key: 'configure',
                                        onClick: () => setShowPlayerDialog(true),
                                        className: 'btn',
                                        style: {
                                            backgroundColor: '#deff01',
                                            color: '#1a202c',
                                            padding: '12px 24px',
                                            borderRadius: '8px',
                                            fontSize: '16px'
                                        }
                                    }, `Configure ${config.totalPlayers} Players`)
                                ]) : createEl('div', { 
                                    key: 'default-info',
                                    style: { marginTop: '20px', fontSize: '14px', color: '#94a3b8', textAlign: 'center' }
                                }, `The system will automatically generate ${config.totalPlayers} players with balanced ratings and mixed genders.`)
                            ]),
                            
                            loading ? createEl('div', { key: 'loading', className: 'spinner' }) : null,
                            
                            createEl('button', { 
                                key: 'generate', 
                                onClick: generateTournament, 
                                disabled: loading || (!config.useDefaults && players.length !== config.totalPlayers),
                                className: 'btn', 
                                style: { 
                                    width: '100%', 
                                    backgroundColor: (loading || (!config.useDefaults && players.length !== config.totalPlayers)) ? '#64748b' : '#deff01', 
                                    color: '#1e293b', 
                                    padding: '18px', 
                                    fontSize: '18px',
                                    fontWeight: 'bold',
                                    borderRadius: '12px'
                                } 
                            }, loading ? 'Generating Tournament...' : 'Generate Tournament'),

                            // Player Dialog
                            createEl(PlayerDialog, {
                                key: 'player-dialog',
                                isOpen: showPlayerDialog,
                                onClose: () => setShowPlayerDialog(false),
                                players,
                                setPlayers,
                                totalPlayers: config.totalPlayers
                            })
                        ])
                    ]);
                }

                // Step 3: Tournament Play
                if (step === 3 && tournament) {
                    const currentRoundData = tournament.schedule[currentRound];
                    const isCurrentRoundComplete = isRoundComplete(currentRound);
                    const isLastRound = currentRound >= tournament.schedule.length - 1;

                    // Tournament Results
                    if (phase === 'completed') {
                        const [results, setResults] = useState(null);
                        
                        useEffect(() => {
                            calculateTournamentResults().then(setResults);
                        }, []);
                        
                        if (!results) {
                            return createEl('div', { 
                                style: { 
                                    minHeight: '100vh', 
                                    background: '#325682', 
                                    color: 'white', 
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    flexDirection: 'column'
                                } 
                            }, [
                                createEl('div', { key: 'loading', className: 'spinner' }),
                                createEl('p', { key: 'text', style: { marginTop: '20px' } }, 'Calculating Results...')
                            ]);
                        }
                        
                        const maleResults = results.filter(p => p.gender === 'M').sort((a, b) => b.totalScore - a.totalScore);
                        const femaleResults = results.filter(p => p.gender === 'F').sort((a, b) => b.totalScore - a.totalScore);
                        const overallResults = results.sort((a, b) => b.totalScore - a.totalScore);
                        const performanceResults = results.sort((a, b) => b.performanceIndex - a.performanceIndex);
                        
                        return createEl('div', { 
                            style: { 
                                minHeight: '100vh', 
                                background: '#325682', 
                                color: 'white', 
                                padding: '24px' 
                            } 
                        }, [
                            createEl('div', { key: 'container', className: 'container' }, [
                                createEl('div', { 
                                    key: 'header', 
                                    style: { textAlign: 'center', marginBottom: '32px' } 
                                }, [
                                    createEl(Trophy, { key: 'trophy' }),
                                    createEl('h1', { 
                                        key: 'title',
                                        style: { fontSize: '32px', fontWeight: 'bold', color: '#deff01', marginTop: '20px' } 
                                    }, 'Tournament Results!')
                                ]),
                                
                                // Overall Winner
                                createEl('div', { key: 'overall-winner', className: 'card' }, [
                                    createEl('h2', { 
                                        key: 'title',
                                        style: { fontSize: '22px', fontWeight: 'bold', color: '#deff01', marginBottom: '16px', textAlign: 'center' } 
                                    }, '🏆 Tournament Champion'),
                                    createEl('div', { 
                                        key: 'winner',
                                        style: { 
                                            textAlign: 'center', 
                                            fontSize: '18px', 
                                            padding: '20px',
                                            backgroundColor: 'rgba(222, 255, 1, 0.2)',
                                            borderRadius: '8px',
                                            border: '2px solid #deff01'
                                        } 
                                    }, [
                                        createEl('div', { 
                                            key: 'name',
                                            style: { fontSize: '22px', fontWeight: 'bold', marginBottom: '8px' } 
                                        }, overallResults[0]?.name),
                                        createEl('div', { 
                                            key: 'score',
                                            style: { fontSize: '16px', color: '#deff01' } 
                                        }, `${overallResults[0]?.totalScore} points • ${overallResults[0]?.wins}/${overallResults[0]?.matchesPlayed} wins`)
                                    ])
                                ]),
                                
                                // Gender Winners
                                createEl('div', { 
                                    key: 'gender-winners',
                                    style: { display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', marginBottom: '24px' }
                                }, [
                                    createEl('div', { key: 'male-winner', className: 'card' }, [
                                        createEl('h3', { 
                                            key: 'title',
                                            style: { fontSize: '16px', fontWeight: 'bold', color: '#deff01', marginBottom: '12px', textAlign: 'center' } 
                                        }, '👨 Male Winner'),
                                        maleResults[0] ? createEl('div', { 
                                            key: 'winner',
                                            style: { textAlign: 'center' }
                                        }, [
                                            createEl('div', { 
                                                key: 'name',
                                                style: { fontSize: '16px', fontWeight: 'bold', marginBottom: '4px' } 
                                            }, maleResults[0].name),
                                            createEl('div', { 
                                                key: 'score',
                                                style: { fontSize: '14px', color: '#deff01' } 
                                            }, `${maleResults[0].totalScore} pts`)
                                        ]) : createEl('div', { 
                                            key: 'no-male',
                                            style: { textAlign: 'center', fontSize: '14px', color: '#94a3b8' } 
                                        }, 'No male participants')
                                    ]),
                                    createEl('div', { key: 'female-winner', className: 'card' }, [
                                        createEl('h3', { 
                                            key: 'title',
                                            style: { fontSize: '16px', fontWeight: 'bold', color: '#deff01', marginBottom: '12px', textAlign: 'center' } 
                                        }, '👩 Female Winner'),
                                        femaleResults[0] ? createEl('div', { 
                                            key: 'winner',
                                            style: { textAlign: 'center' }
                                        }, [
                                            createEl('div', { 
                                                key: 'name',
                                                style: { fontSize: '16px', fontWeight: 'bold', marginBottom: '4px' } 
                                            }, femaleResults[0].name),
                                            createEl('div', { 
                                                key: 'score',
                                                style: { fontSize: '14px', color: '#deff01' } 
                                            }, `${femaleResults[0].totalScore} pts`)
                                        ]) : createEl('div', { 
                                            key: 'no-female',
                                            style: { textAlign: 'center', fontSize: '14px', color: '#94a3b8' } 
                                        }, 'No female participants')
                                    ])
                                ]),
                                
                                // Performance Awards
                                createEl('div', { key: 'performance', className: 'card' }, [
                                    createEl('h3', { 
                                        key: 'title',
                                        style: { fontSize: '16px', fontWeight: 'bold', color: '#deff01', marginBottom: '16px', textAlign: 'center' } 
                                    }, '⭐ Best Performance'),
                                    createEl('div', { 
                                        key: 'top-performers',
                                        className: 'results-grid'
                                    }, performanceResults.slice(0, 3).map((player, index) => 
                                        createEl('div', {
                                            key: index,
                                            className: `result-item ${index === 0 ? 'winner' : ''}`
                                        }, [
                                            createEl('div', { key: 'info' }, [
                                                createEl('div', { 
                                                    key: 'name',
                                                    style: { fontWeight: 'bold', fontSize: '14px' } 
                                                }, `${index + 1}. ${player.name}`),
                                                createEl('div', { 
                                                    key: 'details',
                                                    style: { fontSize: '12px', color: '#94a3b8' } 
                                                }, `Avg: ${player.avgScore} (Expected: ${player.expectedAvgScore})`)
                                            ]),
                                            createEl('div', { 
                                                key: 'performance',
                                                style: { 
                                                    fontSize: '12px', 
                                                    fontWeight: 'bold',
                                                    color: player.performanceIndex > 1.1 ? '#10b981' : player.performanceIndex < 0.9 ? '#ef4444' : '#94a3b8'
                                                } 
                                            }, `${Math.round((player.performanceIndex - 1) * 100)}%`)
                                        ])
                                    ))
                                ]),
                                
                                createEl('button', { 
                                    key: 'restart', 
                                    onClick: () => { 
                                        setStep(1); 
                                        setTournament(null);
                                        setPhase('setup');
                                        setCurrentRound(0);
                                        setScores({});
                                        setRoundStarted(false);
                                        setTimerRunning(false);
                                        setTimeRemaining(0);
                                    }, 
                                    className: 'btn', 
                                    style: { 
                                        width: '100%',
                                        backgroundColor: '#deff01', 
                                        color: '#1e293b', 
                                        padding: '18px', 
                                        fontSize: '18px',
                                        fontWeight: 'bold',
                                        borderRadius: '12px'
                                    } 
                                }, 'Start New Tournament')
                            ])
                        ]);
                    }

                    return createEl('div', { style: { minHeight: '100vh', background: '#325682' } }, [
                        // Header
                        createEl('div', { key: 'header', className: 'header' }, [
                            createEl('button', { 
                                key: 'back', 
                                onClick: () => setStep(1), 
                                className: 'header-back'
                            }, createEl(ChevronLeft)),
                            createEl('h2', { 
                                key: 'title',
                                className: 'header-title'
                            }, phase === 'setup' ? 'REVIEW ROUND 1' : `ROUND ${currentRoundData?.round || 1}`),
                            createEl('div', { key: 'spacer', className: 'header-spacer' })
                        ]),
                        
                        createEl('div', { key: 'content', className: 'container' }, [
                            errorMessage ? createEl('div', { key: 'error', className: 'error-message' }, errorMessage) : null,
                            successMessage ? createEl('div', { key: 'success', className: 'success-message' }, successMessage) : null,
                            
                            // Setup phase
                            phase === 'setup' ? createEl('div', { key: 'setup' }, [
                                createEl('div', { 
                                    key: 'info',
                                    style: { 
                                        backgroundColor: 'rgba(222, 255, 1, 0.2)', 
                                        border: '2px solid #deff01', 
                                        borderRadius: '8px', 
                                        padding: '16px', 
                                        marginBottom: '24px', 
                                        textAlign: 'center'
                                    } 
                                }, [
                                    createEl('h3', { 
                                        key: 'title',
                                        style: { fontSize: '18px', fontWeight: 'bold', marginBottom: '8px' } 
                                    }, '🎯 Round 1 Assignments'),
                                    createEl('p', { 
                                        key: 'desc',
                                        style: { fontSize: '14px', marginBottom: '16px' } 
                                    }, 'Review assignments. Make changes or start Round 1.'),
                                    createEl('div', {
                                        key: 'buttons',
                                        style: { display: 'flex', gap: '12px', justifyContent: 'center', flexWrap: 'wrap' }
                                    }, [
                                        createEl('button', {
                                            key: 'adjust',
                                            onClick: () => setShowSwitchDialog(true),
                                            className: 'btn',
                                            style: {
                                                backgroundColor: '#deff01',
                                                color: '#1a202c',
                                                padding: '12px 20px',
                                                fontSize: '14px',
                                                borderRadius: '8px'
                                            }
                                        }, '✏️ Adjust'),
                                        createEl('button', {
                                            key: 'start',
                                            onClick: startRound,
                                            className: 'btn',
                                            style: {
                                                backgroundColor: '#16a34a',
                                                color: 'white',
                                                padding: '12px 20px',
                                                fontSize: '14px',
                                                borderRadius: '8px'
                                            }
                                        }, '▶️ Start Round 1')
                                    ])
                                ]),
                                
                                // Preview courts
                                ...currentRoundData.matches.map((match, matchIndex) => 
                                    createEl(Court, { 
                                        key: `preview-${matchIndex}`, 
                                        match, 
                                        matchIndex, 
                                        roundIndex: currentRound, 
                                        courtNumber: matchIndex + 1,
                                        scores: {},
                                        updateScore: () => {},
                                        onScoreValidation: () => {},
                                        roundStarted: false
                                    })
                                ),
                                
                                // Sit outs
                                currentRoundData.sit_outs?.length > 0 ? createEl('div', { 
                                    key: 'sitouts', 
                                    style: { 
                                        backgroundColor: 'rgba(107, 114, 128, 0.5)', 
                                        padding: '16px', 
                                        borderRadius: '8px', 
                                        color: 'white',
                                        textAlign: 'center',
                                        marginBottom: '20px'
                                    } 
                                }, [
                                    createEl('strong', { 
                                        key: 'label',
                                        style: { color: '#deff01' } 
                                    }, 'Sitting Out: '), 
                                    createEl('span', { key: 'names' }, currentRoundData.sit_outs.join(', '))
                                ]) : null
                            ]) : [
                                // Playing phase
                                createEl('div', { key: 'timer', style: { textAlign: 'center', marginBottom: '20px' } }, [
                                    !roundStarted ? createEl('button', {
                                        key: 'start-round',
                                        onClick: startRound,
                                        className: 'btn',
                                        style: {
                                            backgroundColor: '#16a34a',
                                            color: 'white',
                                            padding: '12px 24px',
                                            fontSize: '18px',
                                            borderRadius: '8px'
                                        }
                                    }, 'START ROUND') : null,
                                    
                                    roundStarted ? createEl('div', {
                                        key: 'display',
                                        className: `timer-display ${isLastMinute ? 'timer-warning' : 'timer-normal'}`
                                    }, formatTime(timeRemaining)) : null
                                ]),
                                
                                // Active courts
                                ...currentRoundData.matches.map((match, matchIndex) => 
                                    createEl(Court, { 
                                        key: matchIndex, 
                                        match, 
                                        matchIndex, 
                                        roundIndex: currentRound, 
                                        courtNumber: matchIndex + 1,
                                        scores,
                                        updateScore,
                                        onScoreValidation: handleScoreValidation,
                                        roundStarted
                                    })
                                ),
                                
                                // Sit outs
                                currentRoundData.sit_outs?.length > 0 ? createEl('div', { 
                                    key: 'sitouts', 
                                    style: { 
                                        backgroundColor: 'rgba(107, 114, 128, 0.5)', 
                                        padding: '16px', 
                                        borderRadius: '8px', 
                                        color: 'white',
                                        textAlign: 'center',
                                        marginBottom: '20px'
                                    } 
                                }, [
                                    createEl('strong', { 
                                        key: 'label',
                                        style: { color: '#deff01' } 
                                    }, 'Sitting Out: '), 
                                    createEl('span', { key: 'names' }, currentRoundData.sit_outs.join(', '))
                                ]) : null,
                                
                                // Next round button
                                isCurrentRoundComplete ? createEl('button', { 
                                    key: 'next', 
                                    onClick: () => {
                                        if (isLastRound) {
                                            setPhase('completed');
                                        } else {
                                            handleAdvanceRound();
                                        }
                                    },
                                    disabled: loading,
                                    className: 'btn', 
                                    style: { 
                                        width: '100%', 
                                        backgroundColor: loading ? '#64748b' : (isLastRound ? '#805ad5' : '#deff01'), 
                                        color: isLastRound ? 'white' : '#1a202c', 
                                        padding: '16px', 
                                        fontSize: '18px',
                                        fontWeight: 'bold',
                                        borderRadius: '8px'
                                    } 
                                }, [
                                    createEl(CheckCircle, { key: 'icon' }),
                                    createEl('span', { key: 'text' }, loading ? 'Loading...' : (isLastRound ? 'Show Results' : `Next Round (${currentRound + 2}/${tournament.schedule.length})`))
                                ]) : createEl('div', { 
                                    key: 'waiting', 
                                    style: { 
                                        width: '100%', 
                                        backgroundColor: '#718096', 
                                        color: '#cbd5e0', 
                                        fontWeight: 'bold', 
                                        padding: '16px', 
                                        borderRadius: '8px', 
                                        fontSize: '18px', 
                                        textAlign: 'center' 
                                    } 
                                }, 'Enter all scores to continue')
                            ],

                            // Dialogs
                            createEl(ScoreValidationDialog, {
                                key: 'validation',
                                isOpen: scoreValidation.isOpen,
                                onClose: () => setScoreValidation({ ...scoreValidation, isOpen: false }),
                                teamAScore: scoreValidation.teamAScore,
                                teamBScore: scoreValidation.teamBScore,
                                onConfirm: confirmScore
                            }),

                            createEl(SkipPlayerDialog, {
                                key: 'skip-dialog',
                                isOpen: showSkipDialog,
                                onClose: () => setShowSkipDialog(false),
                                tournament,
                                onSkipPlayersSelected: handleSkipPlayersSelected,
                                maxSkips: tournament ? Math.max(0, tournament.players.length - (config.courts * 4)) : 0
                            }),

                            createEl(PlayerSwitchDialog, {
                                key: 'switch-dialog',
                                isOpen: showSwitchDialog,
                                onClose: () => setShowSwitchDialog(false),
                                tournament,
                                currentRound,
                                onSwitchesConfirmed: handleSwitchesConfirmed
                            })
                        ])
                    ]);
                }

                // Default loading state
                return createEl('div', { 
                    style: { 
                        padding: '40px', 
                        textAlign: 'center', 
                        minHeight: '100vh', 
                        background: '#325682', 
                        color: 'white',
                        display: 'flex',
                        flexDirection: 'column',
                        alignItems: 'center',
                        justifyContent: 'center'
                    } 
                }, [
                    createEl(DiNKRLogo, { key: 'logo', size: 'large' }),
                    createEl('div', { key: 'loading', className: 'spinner' })
                ]);
            };

            // Render the app
            try {
                ReactDOM.render(createEl(TournamentApp), document.getElementById('root'));
                console.log('✅ Complete DiNKR Tournament System loaded successfully');
            } catch (error) {
                console.error('Failed to render app:', error);
                document.getElementById('root').innerHTML = `
                    <div style="padding: 20px; text-align: center; background: #325682; color: white; min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                        <h2 style="color: #dc2626; margin-bottom: 20px;">Rendering Error</h2>
                        <p style="margin-bottom: 20px;">Failed to initialize the tournament system.</p>
                        <button onclick="window.location.reload()" style="background: #deff01; color: #1a202c; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold;">Reload</button>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>
